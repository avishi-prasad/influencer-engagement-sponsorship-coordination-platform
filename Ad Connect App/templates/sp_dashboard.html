<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
    <title>AdConnect</title>
    <link rel="stylesheet" href="/static/style.css">
    
</head>
<body>
    {% if flagged %}<br><h5 style="text-align: center; color:red">You have been FlaggedðŸš©.</h5>
    {% else %}
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <span class="navbar-brand"> <i class="fas fa-network-wired"> AdConnect</i></span>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item">
                    <a class="nav-link" href="/sponsor/{{username}}/messages">Messages </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/sponsor/{{username}}/add_campaign">Campaigns</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/sponsor/{{username}}/search">Search </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/sponsor/{{username}}/profile">| {{username}} <i class="fas fa-user-alt"></i> Profile</a>
                </li>
            </ul>
        </div>
    </nav>
    <div class="sidebar">
        <br>
        <br>
        <br>
        <a href="/" class="logout-link">Logout</a>
    </div>
    <div id="app" data-username="{{ username }}">
        <div class="content">
            {% if report %}
                {% if sent %}Report sent on your mail.{% endif %}
                {% if no_email %}Report not sent. Please add your email.{% endif %}
            {% endif %}


            {% if messages %}
                {% if entries %}
                <h5>NEGOTIATION REQUESTS:</h5>
                {% for x in entries %}
                <div class="box">
                    <span>CAMPAIGN NAME: <b>{{ x.camp_name }}{% if x.camp_approved=="approved" %}âœ…{% elif x.camp_approved=="flagged" %}ðŸš© {% else %}ðŸ”µ{% endif %}</b>
                        <br>INFLUENCER : <b>{{ x.inf_name }}{% if x.sp_approved=="approved" %}âœ…{% elif x.sp_approved=="flagged" %}ðŸš© {% else %}ðŸ”µ{% endif %}</b>
                        <br>OFFERED AMOUNT : <b>Rs. {{ x.payment_amount }}</b>
                        <br>REQUESTED AMOUNT : <b>Rs. {{ x.negotiation_amount }}</b>
                        <br>MESSAGE : <b>{{ x.negotiation_message }}</b>
                    </span>
                    <span><a href="/influencer/{{username}}/accept_negotiation_request/{{x.adrequest_id}}"><button style="background-color:rgb(152, 215, 190) ;">Accept</button></a> 
                    <a href="/influencer/{{username}}/reject_negotiation_request/{{x.adrequest_id}}"><button style="background-color: rgb(224, 174, 191);">Reject</button></a>
                    </span>
                </div>
                {% endfor %}
                {% else %}
                <p>No new messages.</p>
                {% endif %}
            {% endif %}


            {% if profile %}
            <h4>Welcome sponsor {{username}} !</h4>
                <p><strong>SPONSOR ID: </strong><span style="font-size: larger;"> {{sp_id}}</span><br>
                <p><strong>SPONSOR NAME: </strong><span style="font-size: larger;"> {{username}}{% if approved=="approved" %}âœ…{% elif approved=="flagged" %}ðŸš© {% else %}ðŸ”µ{% endif %}</span><br> 
                <p><strong>EMAIL ID: </strong><span style="font-size: larger;"> {{email}}</span><br>
                    <button @click="showModal = true;" style="background-color:#aaaedc; color: #1f1616; font-size: smaller;">Edit/Add Email Id </button>
                    <add-sp-email v-if="showModal" @close="showModal = false" @submit="editEmail" :username="'{{username}}'" :email="'{{email}}'"></add-sp-email>        
                <p><strong>APPROVED BY ADMIN: </strong><span style="font-size: larger;"> {% if approved=="approved" %}Approved{% elif approved=="flagged" %}Flagged {% else %}Pending{% endif %}</span><br>
                <p><strong>ON GOING CAMPAIGNS: </strong><span style="font-size: larger;"> {{no_of_active_camps}}</span><br>
                <p><strong>CATEGORY: </strong><span style="font-size: larger;"> {{category}}</span><br>
                    <button @click="showModal3 = true;" style="background-color:#aaaedc; color: #1f1616; font-size: smaller;">Edit/Add Category </button>
                    <add-sp-cat v-if="showModal3" @close="showModal3 = false" @submit="editCategory" :username="'{{username}}'" :category="'{{category}}'"></add-sp-cat>    
                
                <br><br>
                <h5><strong>PENDING AD REQUESTS:</strong></h5>
            {% if pending_requests %}
            <div>
                {% for x in pending_requests %}
            <div class="box">
                <span>CAMPAIGN NAME: <b>{{ x.camp_name }}{% if x.camp_approved=="approved" %}âœ…{% elif x.camp_approved=="flagged" %}ðŸš© {% else %}ðŸ”µ{% endif %}</b>
                    <br>INFLUENCER : <b>{{ x.inf_name }}{% if x.inf_approved=="approved" %}âœ…{% elif x.inf_approved=="flagged" %}ðŸš© {% else %}ðŸ”µ{% endif %}</b>
                </span>
                <span><a href="/sponsor/{{username}}/accept_request/{{x.adrequest_id}}"><button style="background-color:rgb(152, 215, 190) ;">Accept</button></a> 
                <a href="/sponsor/{{username}}/reject_request/{{x.adrequest_id}}"><button style="background-color: rgb(224, 174, 191);">Reject</button></a>
                </span>
            </div>
        
            {% endfor %}
            </div>
            {% else %}
            <div>
                <p>No requests.</p>
            </div>
            {% endif %}<br>
                {% if ending_campaigns %}
            <h5><strong>ENDING CAMPAIGNS:</strong></h5>
            {% for x in ending_campaigns %}
                <div class="box">
                    <span>CAMPAIGN ID: <b>{{ x.campaign_id }}</b>
                        <br>CAMPAIGN NAME: <b>{{ x.name }}{% if x.approved=="approved" %}âœ…{% elif x.approved=="flagged" %}ðŸš© {% else %}ðŸ”µ{% endif %}</b>
                        <br>BUDGET: Rs.<b>{{x.budget}}</b>
                        <br>STARTED ON: <b>{{x.start_date}}</b>
                        <br>END DATE: <b>{{x.end_date}}</b>
                        <br><b><p style="color: #db3838;">{% if x.ending_today %}Campaign ending TODAY.{% endif %}{% if x.ending_passed %}Ending date passed.{% endif %}</p></b>
                    </span>
                    <span><a href="/sponsor/{{username}}/end_campaign_page/{{ x.campaign_id }}"> <button style="background-color: #b6e6ad;">Pay and End</button></a>
                </div>
                {% endfor %}
            {% endif %}
            <br>
            

            
            {% if pending_requests_by_sp %}
            <h5><strong>PENDING AD REQUESTS SENT BY YOU:</strong></h5>
            <div>
                {% for x in pending_requests_by_sp %}
            <div class="box">
                <span>CAMPAIGN NAME: <b>{{ x.camp_name }}{% if x.camp_approved=="approved" %}âœ…{% elif x.camp_approved=="flagged" %}ðŸš© {% else %}ðŸ”µ{% endif %}</b>
                    <br>INFLUENCER : <b>{{ x.inf_name }}{% if x.inf_approved=="approved" %}âœ…{% elif x.inf_approved=="flagged" %}ðŸš© {% else %}ðŸ”µ{% endif %}</b>
                </span>
                <span><a href="/sponsor/{{username}}/delete_adrequest/{{x.adrequest_id}}"><button style="background-color:rgb(224, 174, 191);">Delete Request</button></a> 
                </span>
            </div>
            
            {% endfor %}
            </div>
            {% endif %}
            
            {% endif %}
    
            {% if campaign %}
            <h4>ADD CAMPAIGNS:</h4><br>
            <button @click="showModal = true;" style="background-color:#db3838; color: #FFFFFF;">Add New Campaign</button>
            <ad-camp v-if="showModal" @close="showModal = false" @submit="addCampaign" :username="'{{username}}'"></ad-camp>
            <br><br>
            <h5>YOUR ACTIVE CAMPAIGNS:</h5>
            {% if active_campaigns %}
            <div>
                {% for x in active_campaigns %}
                <div class="box">
                    <span>CAMPAIGN ID: <b>{{ x.campaign_id }}</b>
                        <br>CAMPAIGN NAME: <b>{{ x.name }}{% if x.approved=="approved" %}âœ…{% elif x.approved=="flagged" %}ðŸš© {% else %}ðŸ”µ{% endif %}</b>
                        <br>DESCRIPTION: <b>{{x.description}}</b>
                        <br>BUDGET: Rs.<b>{{x.budget}}</b>
                        <br>STARTED ON: <b>{{x.start_date}}</b>
                        <br>END DATE: <b>{{x.end_date}}</b>
                        <br><b><p style="color: #db3838;">{% if x.ending_today %}Ending TODAY...{% endif %}{% if x.ending_passed %}End date passed.{% endif %}</p></b>
                    </span>
                    <span><a href="/sponsor/{{username}}/view_camp/{{x.campaign_id}}"><button style="background-color:rgb(152, 215, 190) ;">View Details</button></a> 
                        <button @click="showModal2 = true;" style="background-color:#ADD8E6">Edit Campaign</button>
                        <edit-camp v-if="showModal2" @close="showModal2 = false" @submit="editCampaign" :username="'{{username}}'" :camp_name="'{{x.name}}'" :camp_id="'{{ x.campaign_id }}'" :camp_desc="'{{x.description}}'" :camp_budget="'{{x.budget}}'" :camp_end_date="'{{x.end_date}}'"></edit-camp>
                        <br><a href="/sponsor/{{username}}/delete_camp/{{x.campaign_id}}"><button style="background-color: rgb(224, 174, 191);">Delete Campaign</button></a>
                        <a href="/sponsor/{{username}}/end_campaign_page/{{ x.campaign_id }}"> <button style="background-color: #b6e6ad;">Pay and End</button></a>
                        <br><a href="/sponsor/{{username}}/get_report/{{ x.campaign_id }}">Get report on mail</a>
                    </span>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div>
                <p>No active campaigns.</p>
            </div>
            {% endif %}

            <br><br>
            {% if ended_campaigns %}
            <h5>YOUR ENDED CAMPAIGNS:</h5>
            <div>
                {% for x in ended_campaigns %}
                <div class="box">
                    <span>CAMPAIGN ID: <b>{{ x.campaign_id }}</b>
                        <br>CAMPAIGN NAME: <b>{{ x.name }}{% if x.approved=="approved" %}âœ…{% elif x.approved=="flagged" %}ðŸš© {% else %}ðŸ”µ{% endif %}</b>
                        <br>ENDED ON: <b>{{x.end_date}}</b>
                    </span>
                    <span><a href="/sponsor/{{username}}/get_report/{{ x.campaign_id }}">Get report on mail</a>
                    </span>
                </div>
                {% endfor %}
            </div>
            {% endif %}
            {% endif %}

            {% if search %}
            <sp-search-bar :username="'{{username}}'"></sp-search-bar><br>
            <div>
            {% if influencers and influencers|length > 0 %}
                <div>
                {% for x in influencers %}
                <div class="box" style="background-color: #bddbbd;">
                    <span>INFLUENCER NAME: <b>{{ x.user_name }}{% if x.approved=="approved" %}âœ…{% elif x.approved=="flagged" %}ðŸš© {% else %}ðŸ”µ{% endif %}</b>
                        <br>CATEGORY : <b>{{ x.category }}</b>
                        <br>FOLLOWERS : <b>{{ x.followers }}</b>
                        <br>RATING: <b>{{x.rating}}<span style="color:#FFD700; ">â˜…</span></b>
                    </span>
                    <span><a href="/sponsor/{{username}}/details/inf/{{x.user_id}}"><button>See Details</button></a></span>
                </div>
                {% endfor %}
                </div>
                {% else %}
                <div>
                    {% if not msg %}<p>No influencers found.</p>{% endif %}
                </div>
            {% endif %}

            <div>
            {% if msg %}
            <p>Oops! No matches found.</p>
            {% endif %}
            </div>
            
            {% endif %}
            {% if result %}<p><a href="/sponsor/{{username}}/search">Show all influencers</a></p>{% endif %}
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="/static/vue.js"></script> 
    {% endif %}
</body>
</html>
